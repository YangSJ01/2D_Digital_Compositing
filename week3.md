# week3
> ### color-management-fundamentals-aces-workflows-in-nuke [video](https://www.youtube.com/watch?v=Hlj5ep-85ys)
* 누크 작업 공정에 관한 전반적인 이야기.
* _Color Management_     
    색공간 변환을 통제하는 프로토콜로서 이미지 재현과 창작 의도를 다양한 장치 및 모든 부서에서 공통된 시각에 맞추어 작업할 수 있도록 일관성 있게 제공하는 프레임워크이다.
    즉, 모두가 어디에서든 각자 스크린에서 같은 이미지를 보도록 하는 것, 예술가의 의도가 정확히 표현되도록 작업하는 방식이다.
    디지털 카메라가 발명되기 색공간 3개를 혼합하는 방식을 사용했지만, 현재에는 변화할 필요가 있다. 디지털카메라가 등장했기 때문이다. 다양한 색공간을 표현해야 한다. 
    색공간은 특정한 색상 구성. 색상 모델에서 유래한 색 구성 성분을 조합한 것. 팬톤 색상표나 좌표로 표현. 인간의 가시 스펙트럼
    휘도에 상관없는 색상, 색도를 Color Wheel로 조절한다. 이때, 가시 스펙트럼에서 빛의 파장 수용하기 위해 카테시안 도표를 사용할 수 있다. 
    휘도 성분을 Y(대문자 와이)로 추가적으로 표현하기도 하지만, 튜플(x,y)로만 나타내는 것이 일반적이다.
    그렇게 만들어진 Spectral Locus(스펙트럼 궤적)은 CIE xy Chromaticity Diagram이라고 불리기도 한다. 
    인간 시각의 색역을 나타낸다. 그래서 모든 표본은 인간 시간의 색역 안에 있다. 안에 없는 표본은 색역 외부에 있지만, 수학적으로 존재하고 우리가 볼 수 없다.
    이 개념을 바탕으로 평균 인간 시각에 대해 상대적인 기준색역과 절대구역인 목표색역으로 구분할 수 있다.
    색역 : 색상의 강도/ 색상이 재현하는 범위의 한계 설정
    또, 등온선을 통해 색온도를 유지하면서 마젠타 성분을 바꿀수 있다. 
    sRGB는 Primary color(원색)에 각각 점을 찍어 삼각형을 만든 색공간으로, 대부분의 컴퓨터가 사용한다.
* _Transfer Function_     
    색공간의 필수적 요소인 전달함수로 이미지 캡쳐 장치의 선형 3색 자극값과 비선형 전자 신호값의 매핑값을 말한다.
    이미지 입력 장치(ex. 카메라)가 담는 모든 빛의 표현과 노출도 색공간 내 정확한 위치에 배분할 수 있다. 그래서 이 방식으로 센서를 만들어 영상결과물 기록 성능과 카메라의 전체 색상 재현 능력을 최적화한다.
    Linear(Lin)은 인풋과 아웃풋이 동일한 선형 광선이다.
    Logarithmic(Log)는 빛의 움직임을 정확하게 나타낸다.
    Gamma는 원래 CRT모니터 표준값 0과1로 곡선의 종점을 그대로 유지하며 SDR에 속한다.
    HDR은 일반 화이트 포인트보다 더 밝은 값의 신호를 나타낼 수 있게 해서 더 특별한 전달함수가 필요했다. Hybrid Log-Gamma(HLG)와 Perceptual Quantizer(PQ)가 있다.
* _Look Up Table(LUT)_   
    대응점으로 구성된 데이터의 단순한 배열이다. (ex. 사전) 또한, 입력 색상값을 출력 색상값으로 변환하는 것이다.(=리매핑 작업)
    함수 결과나 배열에 저장된 임시값으로 배열을 사전 산출할 수 있다. 그래서 컴퓨터는 단순히 영상의 모든 화소에 읽은 값을 재배당하는 것이다.
    전달함수는 특정 유형의 LUT라고 할 수 있다. LUT는 한 색공간을 다른 공간으로 변환한다는 뜻으로 
    RGB의 각 구성요소는 모두 고유 배열과 함수가 있다.
    LUT는 모든 원색 변환을 적용해서 크리에이티브 룩을 나타내는 데 사용 할 수 있다. 2차 색 변환과 반대되는 작업으로 모든 이미지 화소에 지정값을 리매핑하는 것에 기반한 고정색 변환이며 다양한 목적에 사용한다.
* _Brief Story of the Color Transfer Odyssey_    
    옛날에는 필름카메라의 네거티브 필름을 현상한 후 포지티브 필름으로 변환하고 빛에 노출하면 끝이었다. (아날로그식 물리적 지원) 하지만, 필름을 TV로 보려면 물리적 장치를 전자 신호로 변환해야 했다. 그래서 텔레시네를 사용했다.(비디오카메라) 빛이 반대로 찍힌 네거티브 필름을 테이프로 저장하는 방식을 사용했지만, 자기장을 사용한 아날로그 방식이다. 개인 컴퓨터와 CRT모니터가 보급되기 시작하면서, 어떤 이미지 문서든 볼 수 있게 하려면 소프트웨어로 보정해야 했다. 그리고 모든 소프트웨어는 각자 고유의 색상을 구현했다. 컴퓨터와 모니터는 진화해서 모든게 새로 구축된 sRGB색공간을 따르게 되었다. 그래서 이미지가 제대로 보이게 되었다. (모니터와 소프트웨어 색상 일치) 한편, 필름 스캐너가 발명되고 디지털 색보정이 탄생했다. 'DI'라는 과정으로 원본 네거 필름을 스캔해서 10bit의 시네온 파일 시퀀스로 변환했다. 스캔 이후 과정은 모두 디지털로 처리되었지만 아날로그 방식으로 상영하도록 영사 슬라이드로 다시 바꿔서 출력했다. 하지만 디지털 영사기가 사용화된 후, 배급업계는 변화했고 DCP(세 디지털 시네마 패키지)는 인터넷으로 전송되었다. 영화가 완전히 디지털 방식화 되어갔다. 하지만 본격적인 때는 디지털카메라가 발명된 이후이다. 네거필름을 스캔할 필요가 없어졌기 때문이다. 또, TV가 CRT를 버리고 디지털로 바뀌면서 LCD(Liquid-Crystal Display)를 선택했다. TV가 컴퓨터와 같은 속도로 진화하기 시작하면서 SD화질과 세계 공통의 HD로 나아갔다. 720p와 1080p 두 버전이 있었지만 동일한 색공간을 활용했다. 또한, 국제전기통신연합의 추천으로  HDTV의 표준이 되었다. 추천번호 709번, ITU-R BT.709.(Rec.709) sRGB와 똑같은 원색과 화이트 포인트를 유지하지만 감마나 전달함수를 약간 바꿔서 새 장치에서 더 나은 색상을 나타내려했다. 더 큰 화질, 색공간, 비트 심도를 추구하면서 4K HDR TV가 나왔다. 이어서 시장에서는 대형 스크린과 더 강력한 프로젝터를 집중적으로 생산하는 동안, 사람들은 핸드폰과 태블릿으로 콘텐츠를 시청했다. 휴대성과 대형스크린이 대결 구도에 오르게 된 것이다. DI(디지털 중간 작업)는 더 복잡해졌다. 그래서 색상과 비트 심도, 시각화가 되지 않는 다이나믹 영역을 LUT를 사용해 서로 다른 장치로 변환했다. 이미지가 생성되는 장소와 전송 위치에 따라 달랐고, 매 최종본을 저장해야 했으며 더 좋은 화질을 표현하는 기술이 나오면 기존의 영상이 무용지물이 되는 문제가 있었다. 이에 모든 디스플레이에 적합하도록 실제 이미지 데이터를 바꾸는 방식을 사용해기존의 파일이 새 기술과 디스플레이에 적용되게 만들었다.(=Display Referred)
    * _Display Referred vs Scene Referred_     
    Scene Referred Color Splace Workflow는 먼저 마스터 색 공간을 선택해야 한다. 현재에는 HER 호환성도 갖춰야 한다. 통합 색공간은 디스플레이의 차이는 없고 색상 데이터의 수학적 보관 용기로 보면 된다. 다음에는 입력 변환을 적용해 로우 데이터를 변환한다. 혹은 각 장치의 소스 자료를 통합 공간에 넣는다. 렌더링한 CGI를 바로 인코딩해서 통합 색공간으로 넣기 때문에 변환할 필요가 없다. 물론, 전통적인 sRGB선형으로 미리 렌더링 했다면 원하는 통합 색공간으로 언제든지 변환할 수 있다. 문제는 통합 색공간으로 바로 렌더링할 거라면 불필요한 변환을 지양해야 한다. 모든 게 동일한 색공간에 있으면 같은 규칙을 따른다. 동일 범위, 화이트 화인트 같은 전달함수를 사용한다. 이때, 모든 영상이 같은 구역에 있다고 여러 소스에서 나온 모든 이미지가 색공간을 다 쓰는 것은 아니다. 즉, 이 마스터 색공간의 규칙을 따르는 외부 파일을 통합 색공간의 이미지에 적용할 수 있다. 이미지에 대한 모든 색변환은 소스의 성능에 따라 좌우된다. 하지만, 색상 조정이란 관점에선 모두 같다. 그래서 마스터 영상에 모든 데이터와 표현 의도를 같이 온전히 담을 수 있고 그 영상이 다른 부서로 넘어갈 때 모든 사람이 스크린으로 보는 것과 동일한 색공간에 있는 영상이 모두 일치한다는 점에서 표현 의도를 언제나 유지하게 된다. 예시로 VFX부서에서 누크의 영상을 읽어서 모니터나 영사기, TV에 따라 적절한 디스플레이 변형으로 시청자에게 적용할 수 있다. 그리고 이 장면에 지정된 표현 의도를 시청자가 볼 수 있도록 영화 제작자가 원하는 이미지를 스크린으로 보우지만 영상은 온전히 남아있다. 그저 시청자를 위한 시각화 보정을 한 것이다. 작업을 완료하면 DI로 넘어가고 표현 의도를 고려해서 최종 색보정을 하게 된다. 보정 작업 이후 모든 최종 디스플레이 장치에 맞춰 디스플레이 변환을 시작한다. 각각 고유의 색공간과 특성이 있어서 임의로 더 좁은 색공간으로 이동한다면 목표색에 맞게 색보정을 약간 바꿔야 한다.(극장과 TV) 색 보정이 끝나고 납품되면 기록을 보관하게 된다. 마스터 파일을 수거하고 보정과정은 색 변환으로 저장된다. 그래야 미래에 복원하고 앞으로 발명될 장치로 전달 할 수 있다. 즉, 미래를 대비하는 Workflow 인 것이다. 색 보정은 처음과 끝에 한번씩, 납품할 때마다 진행하는데 그 중간 과정은 시각화 변환이다. 하지만, 전체 영상 작업 공정은 색공간의 관점에선 전혀 변화가 없다.     
    _실제 주요한 차이점은 Workflow에서 발생한다._ Display Referred를 예로 들면, 영상을 디스플레이에 따른 색상 변형을 해야 제대로 볼 수 있게 된다. 반연, Scene Referred에서 색상 변형을 적용할때에는 영상을 참조하고 모든 디스플레이에 적용할 수 있다. 결과적으로 Display Referred의 예에서 LUT를 적용해 한 색상을 변환해서 다른 색공간으로 바꿔야 한다. 모든 디스플레이마다 하니 변환을 많이 할 수밖에 없어 일관성을 해치고 실수의 위험이 있다. 반면 Scene Referred의 경우는 모든 영상 변환을 마스터 색공간으로 바꿔서 영상 시각화 작업을 진행한다. 지정 디스플레이에 맞춰 단순하게 진행하면 된다. 전 과정을 단순화해서 모든 사람이 전 작업공정에서 영상을 후헤손하지 않고 작업 내용을 잘 숙지할 수 있다.
* _RGB Color Space : Elements_      
    3 Primaries define the Gamut - 색공간의 색역을 지정하는 삼원색     
    White Point defines the Center - 색역의 중심을 정의하고 색도가 가장 낮은 지점, 백색     
    Transfer Function(전달함수) - 선형 3색 자극값과 비선형 전자 신호값 사이를 매핑하도록 지정하고 색공간 내에서 색 표본 데이터를 분배한다.    
------------------------------------------
    > ### Gamma
*
> ### Linear Workflow
* 감마 값을 조정해서 원래의 색깔을 컴퓨터 모니터를 통해 재현하는 것.

> ### Alpha-Premult/Straight
*
